function initialize(){M.Tabs.init(document.querySelectorAll(".tabs"),{}),M.Collapsible.init(document.querySelector(".collapsible"),{}),fetch("fragment/classlist.html?ver=1").then(function(e){return e.text()}).then(function(e){document.querySelector("#classlist").innerHTML=e})}function doSearch(){document.getElementById("searchTxt").innerHTML='<i class="material-icons left searchIcon">details</i>Searching';var e=document.getElementById("tableBody"),t=document.getElementById("headIntake"),n=document.getElementById("headModule");t.removeAttribute("style"),n.removeAttribute("style"),e.innerHTML="";var a=document.getElementById("emptyInfo");a.style.display="none";var l=document.querySelector(".emptyClass").checked?"on":"",s=document.getElementById("searchInfo"),o=document.getElementById("resultArea"),c=document.getElementById("tutorial"),i=document.querySelector(".dateDay:checked").value,r=document.getElementById("hidemsg"),d=document.getElementById("searchVal").value;navigator.onLine?postMe("control/logic.php","classroom="+d+"&date="+i+"&emptyClass="+l).then(function(l){"empty"==l[0].method||"invalid"==l[0].method||"noinput"==l[0].method?(c.style.display=o.style.display=r.style.display="none",s.innerHTML=d+" seems "+l[0].method+" on "+i):(c.style.display="none",o.removeAttribute("style"),r.removeAttribute("style"),s.style.display="block",s.innerHTML="Results for "+d+" on "+i,o.removeAttribute("style"),l.forEach(function(l){"emptyclassroom"==l.method?(t.style.display="none",n.style.display="none",e.innerHTML+='<tr><td class="hide-on-small-only">'+l.date+"</td><td>"+l.time+"</td><td>"+l.classroom+"</td><td>"+l.lecturer+"</td></tr>","emptyNow"==l.status?a.style.display="block":a.style.display="none"):e.innerHTML+="<tr><td>"+l.intake+'</td><td class="hide-on-small-only">'+l.date+"</td><td>"+l.time+"</td><td>"+l.classroom+"</td><td>"+l.module+"</td><td>"+l.lecturer+"</td></tr>"}),o.classList.add("tableInAnim")),document.getElementById("searchTxt").innerHTML='<i class="material-icons left">lightbulb_outline</i>Search'}):(M.toast({html:"You are offline!",displayLength:"5000"}),c.style.display="none",s.innerHTML='<i class="material-icons left">portable_wifi_off</i><h5>No internet connection</h5>')}function changemytimetable(){navigator.onLine||M.toast({html:"You are offline!",displayLength:"5000"}),changeTab("brown darken-4","#3e2723")}function changeavailable(){navigator.onLine?postMe("control/available.php","classroom=available").then(function(e){emptyclasses=e,queryavailableclass("All")}):M.toast({html:"You are offline!",displayLength:"5000"}),changeTab("blue darken-3","#0d47a1")}function queryavailableclass(e){var t=document.getElementById("availableClasses"),n=document.getElementById("filtertype"),a="",l=0;t.innerHTML="",emptyclasses.forEach(function(s){switch(e){case"APIIT Labs":if(!s.classroom.toLowerCase().includes("lab l3"))return;a=createclassblock(s.classroom,s.nextclass,l);break;case"APU Labs":if(!s.classroom.toLowerCase().includes("lab")||s.classroom.toLowerCase().includes("lab l3"))return;a=createclassblock(s.classroom,s.nextclass,l);break;case"Block-B":if(!s.classroom.includes("B-"))return;a=createclassblock(s.classroom,s.nextclass,l);break;case"Block-D":if(!s.classroom.includes("D-"))return;a=createclassblock(s.classroom,s.nextclass,l);break;case"Block-E":if(!s.classroom.includes("E-"))return;a=createclassblock(s.classroom,s.nextclass,l);break;case"All":a=createclassblock(s.classroom,s.nextclass);break;default:a="<h5>No data found</h5>"}n.innerHTML=e,t.innerHTML+=a,l++})}function createclassblock(e,t,n){return n=n||0,textcolor="none"==t.trim()?"cyan-text text-darken-3":"","<div class='col s6 m3'><div class='card-panel fadein' style='animation-delay: "+n/15+"s;><span class='card-title'>"+e+"</span><p class='"+textcolor+"'>Next class : "+t+"<span></p></div></div>"}function hidethead(){var e=document.getElementById("tableHead");"none"===e.style.display?(e.style.display="block",document.cookie="apuschedule-tablehead=;expires=Thu, 01 Jan 1970 00:00:00 UTC;"):(e.style.display="none",document.cookie="apuschedule-tablehead=hidden;expires=Mon, 31 Dec 2018 20:00:00 UTC; path=/;")}function postMe(e,t){return new Promise(function(n,a){var l=new XMLHttpRequest;l.onload=function(){n(JSON.parse(this.responseText))},l.onerror=a,l.open("POST",e),l.setRequestHeader("Content-type","application/x-www-form-urlencoded"),l.setRequestHeader("Accept","application/json"),l.send(t)})}function changeTab(e,t){document.getElementById("headercolor").className="nav-extended "+e,document.querySelector("meta[name=theme-color]").setAttribute("content",t)}emptyclasses=[],window.addEventListener?window.addEventListener("load",initialize,!1):window.attachEvent?window.attachEvent("onload",initialize):window.onload=initialize,document.getElementById("searchVal").addEventListener("keyup",function(e){e.preventDefault(),13===e.keyCode&&doSearch()});
